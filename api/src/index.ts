import Fastify from 'fastify';import cors from '@fastify/cors';import 'dotenv/config';const app=Fastify({logger:true});const PORT=Number(process.env.PORT||4000);const ORIGIN=(process.env.CORS_ORIGIN||'*').split(',');await app.register(cors,{origin:ORIGIN});const hotel={slug:'sunrise',name:'Sunrise Resort',description:'Hill-view stay powered by VAiyu'};const services=[{key:'towel',label_en:'Towel',sla_minutes:25},{key:'room_cleaning',label_en:'Room Cleaning',sla_minutes:30},{key:'water_bottle',label_en:'Water Bottles',sla_minutes:20},{key:'laundry_pickup',label_en:'Laundry Pickup',sla_minutes:30},{key:'extra_pillow',label_en:'Extra Pillow',sla_minutes:20}];const menu=[{item_key:'veg_sandwich',name:'Veg Sandwich',base_price:120},{item_key:'masala_tea',name:'Masala Tea',base_price:40}];let tickets:any=[];let orders:any=[];let folio:any={lines:[{description:'Room (EP)',amount:2800}],total:2800};app.get('/hotels',async(req,reply)=>{const q=(req.query as any).slug;return q===hotel.slug?hotel:hotel});app.get('/catalog/services',async(req,reply)=>({items:services}));app.get('/menu/items',async(req,reply)=>({items:menu}));app.post('/tickets',async(req,reply)=>{const body:any=req.body||{};const t={id:String(Date.now()),status:'Requested',...body};tickets.push(t);return {ok:true,ticket:t}});app.post('/orders',async(req,reply)=>{const body:any=req.body||{};const o={id:String(Date.now()),status:'Placed',...body};orders.push(o);return {ok:true,order:o}});app.get('/folio',async(req,reply)=>folio);app.post('/precheck',async(req,reply)=>({ok:true}));app.post('/regcard',async(req,reply)=>({ok:true,pdf:'/fake.pdf'}));app.post('/checkout',async(req,reply)=>({ok:true,invoice:'/invoice.pdf',review_link:'https://example.com/review'}));app.post('/payments/checkout',async(req,reply)=>({link:'https://pay.example.com/abc123'}));app.post('/payments/webhook',async(req,reply)=>{folio.lines.push({description:'UPI Payment',amount:-2800});folio.total=folio.lines.reduce((s:number,l:any)=>s+(l.amount||0),0);return {ok:true}});app.listen({port:PORT,host:'0.0.0.0'},(err,addr)=>{if(err){app.log.error(err);process.exit(1)}app.log.info(`API listening on ${addr}`)})